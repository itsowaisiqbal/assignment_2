{"version":3,"sources":["src/MainScene.js"],"names":["score","bestScore","Number","localStorage","getItem","isThemePlaying","MainScene","load","image","audio","winSound","sound","add","theme","failSound","flipSound","play","loop","volume","gw","game","config","width","gh","height","startDragY","addBackground","addScoreText","addFloor","addBottle","addDragEvents","Math","abs","bottle","angle","hasFlippedInAir","isStanding","isTouched","time","delayedCall","setItem","scene","restart","body","velocity","y","background","setOrigin","setDisplaySize","textConfig","fontFamily","fontSize","scoreText","text","bestScoreText","floor","floorBody","matter","rectangle","displayWidth","displayHeight","isStatic","Bottle","input","setDraggable","setOnCollideActive","bottleTouchFloor","on","activePointer","flip","Phaser","Scene"],"mappings":"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","file":"MainScene.16c28e04.js","sourceRoot":"..","sourcesContent":["let score = 0;\r\n// save best score to the browser\r\nlet bestScore = Number(localStorage.getItem(\"bestScore\")) || 0;\r\nlet isThemePlaying = false;\r\n\r\nclass MainScene extends Phaser.Scene \r\n{\r\n  constructor() \r\n  {\r\n    super(\"MainScene\");\r\n  }\r\n\r\n  preload() \r\n  {\r\n    //preloading images\r\n    this.load.image(\"background\", \"./assets/background.png\");\r\n    this.load.image(\"bottle\", \"/assets/bottle.png\");\r\n    this.load.image(\"floor\", \"./assets/floor.png\");\r\n    this.load.audio(\"win\", [\"./assets/win.mp3\"]);\r\n\r\n    this.load.audio(\"theme\", [\"./assets/theme.ogg\"]);\r\n    this.load.audio(\"fail\", [\"./assets/fail.mp3\"]);\r\n    this.load.audio(\"flip\", [\"./assets/flip.mp3\"]);\r\n  }\r\n\r\n  create() \r\n  {\r\n    this.winSound = this.sound.add(\"win\");\r\n    this.theme = this.sound.add(\"theme\");\r\n    this.failSound = this.sound.add(\"fail\");\r\n    this.flipSound = this.sound.add(\"flip\");\r\n\r\n    !isThemePlaying && this.theme.play({ loop: true , volume: 0.1 });\r\n\r\n    isThemePlaying = true;\r\n\r\n    this.gw = this.game.config.width;\r\n    this.gh = this.game.config.height;\r\n\r\n    this.startDragY = 0;\r\n\r\n    this.addBackground();\r\n    this.addScoreText();\r\n\r\n    this.addFloor();\r\n    this.addBottle();\r\n    this.addDragEvents();\r\n  }\r\n\r\n  update() \r\n  {\r\n    //CHECK IF THE BOTTLE HAS FLIPPED IN AIR\r\n    if (Math.abs(this.bottle.angle) > 160) \r\n    {\r\n      this.bottle.hasFlippedInAir = true;\r\n    }\r\n  }\r\n\r\n  bottleTouchFloor() \r\n  {\r\n    //CHECKING IF THE BOTTLE IS STANDING STRAIGHT AND HAS BEEN TOUCHED\r\n    if (this.bottle.isStanding() && this.bottle.isTouched) \r\n    {\r\n      // delay for the bottle to completely decelerate\r\n      this.time.delayedCall(2000, () => \r\n      {\r\n        //MAKING SURE THAT BOTTLE IS STANDING\r\n        if (this.bottle.isStanding()) \r\n        {\r\n          this.winSound.play();\r\n          // prevent score add bug\r\n          if (this.bottle.hasFlippedInAir) \r\n          {\r\n            score++;\r\n          }\r\n\r\n          if (score > bestScore) \r\n          {\r\n            bestScore = score;\r\n            localStorage.setItem(\"bestScore\", bestScore);\r\n          }\r\n\r\n          this.scene.restart();\r\n\r\n          // check if bottle is not standing\r\n        } \r\n        else if (this.bottle.body.velocity.y === 0 && this.bottle.isTouched) \r\n        {\r\n          this.scene.restart();\r\n          this.failSound.play();\r\n        }\r\n      });\r\n    }\r\n\r\n    // check if bottle is not standing\r\n    if (this.bottle.body.velocity.y === 0 && this.bottle.isTouched) \r\n    {\r\n      this.scene.restart();\r\n      this.failSound.play();\r\n    }\r\n  }\r\n\r\n  addBackground() \r\n  {\r\n    this.background = this.add\r\n      .image(0, 0, \"background\")\r\n      .setOrigin(0, 0)\r\n      .setDisplaySize(this.gw, this.gh);\r\n  }\r\n\r\n  addScoreText() \r\n  {\r\n    const textConfig = \r\n    {\r\n      fontFamily: 'Georgia, \"Goudy Bookletter 1911\", Times, serif',\r\n      fontSize: \"80px\",\r\n    };\r\n\r\n    this.scoreText = this.add\r\n      .text(10, 10, \"score \" + score, textConfig)\r\n      .setOrigin(0, 0);\r\n\r\n    this.bestScoreText = this.add\r\n      .text(this.gw - 10, 10, \"best \" + bestScore, textConfig)\r\n      .setOrigin(1, 0);\r\n  }\r\n\r\n  addFloor() \r\n  {\r\n    this.floor = this.add.image(0, this.gh, \"floor\").setOrigin(0, 1);\r\n\r\n    // floor hitbox\r\n    this.floorBody = this.matter.add.rectangle(\r\n      this.gw / 2,\r\n      this.gh - 40,\r\n      this.floor.displayWidth,\r\n      this.floor.displayHeight,\r\n      { isStatic: true }\r\n    );\r\n  }\r\n\r\n  addBottle() \r\n  {\r\n    this.bottle = new Bottle(this, this.gw / 2, this.floor.y, \"bottle\");\r\n    this.bottle.y -= this.bottle.height / 2;\r\n\r\n    // set bottle draggable\r\n    this.input.setDraggable(this.bottle);\r\n\r\n    // bottle touching floor callback\r\n    this.bottle.setOnCollideActive(() => this.bottleTouchFloor());\r\n  }\r\n\r\n  addDragEvents() \r\n  {\r\n    // we need store start Y to check drag distance\r\n    this.input.on(\r\n      \"dragstart\",\r\n      (activePointer) => (this.startDragY = activePointer.y)\r\n    );\r\n\r\n    // flip bottle\r\n    this.input.on(\"dragend\", (activePointer) => \r\n    {\r\n      this.flipSound.play();\r\n      this.bottle.flip(activePointer.y);\r\n      this.bottle.isTouched = true;\r\n    });\r\n  }\r\n}"]}